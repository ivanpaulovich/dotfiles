let $RTP=split(&runtimepath, ',')[0]
let $VIMRC="$HOME/.vim/vimrc"

set nocompatible

" the prefix to use for leader commands
let g:mapleader="<space>"

" Key mapping
nnoremap <Leader>w :w<CR>
vmap <Leader>y "+y
vmap <Leader>d "+d
nmap <Leader>p "+p
nmap <Leader>P "+P
vmap <Leader>p "+p
vmap <Leader>P "+P
vnoremap . :normal.<CR>

call plug#begin()

" Quick search
Plug 'junegunn/fzf'
Plug 'junegunn/fzf.vim'

" Status line 
Plug 'vim-airline/vim-airline'
Plug 'vim-airline/vim-airline-themes'

" Themes
Plug 'gruvbox-community/gruvbox'

" Coc
Plug 'neoclide/coc.nvim'
Plug 'neoclide/coc-snippets'
Plug 'neoclide/coc-tsserver'
Plug 'neoclide/coc-prettier'
Plug 'neoclide/coc-eslint'
Plug 'neoclide/coc-tslint'
Plug 'neoclide/coc-css'
Plug 'neoclide/coc-lists'
Plug 'neoclide/coc-highlight'

" C#
Plug 'OmniSharp/omnisharp-vim'

" Linting/error highlighting
Plug 'dense-analysis/ale'

Plug 'sirver/ultisnips'

call plug#end()

set autoindent
set modifiable
set backspace=indent,eol,start
set history=1000
set showcmd
set showmode
set autoread
set ruler
set wildmenu
set wildmode=longest:full,full
set tabpagemax=40
set noerrorbells
set mouse=a
set background=dark
set title
set laststatus=2
set path=.,**
set completeopt=longest,menuone,popuphidden
set completepopup=highlight:Pmenu,border:off
set expandtab
set shiftround
set shiftwidth=4
set softtabstop=-1
set tabstop=8
set textwidth=80
set hidden
set nofixendofline
set nostartofline
set splitbelow
set splitright
set nohlsearch
set incsearch
set noruler
set noshowmode
set wrap!
set scrolloff=8
set colorcolumn=80
set smartindent
set timeoutlen=1000
set ttimeoutlen=50

set cursorline
hi CursorLine cterm=NONE ctermbg=black

" Line numbers
set number

augroup numbertoggle
  autocmd!
  autocmd BufEnter,FocusGained,InsertLeave,WinEnter * if &nu && mode() != "i" | set rnu   | endif
  autocmd BufLeave,FocusLost,InsertEnter,WinLeave   * if &nu                  | set nornu | endif
augroup END

" Syntax highlight
syntax on

filetype indent plugin on
if !exists('g:syntax_on') | syntax enable | endif
set encoding=utf-8
scriptencoding utf-8

" ALE: {{{
let g:ale_sign_error = '•'
let g:ale_sign_warning = '•'
let g:ale_sign_info = '·'
let g:ale_sign_style_error = '·'
let g:ale_sign_style_warning = '·'

let g:ale_linters = { 'cs': ['OmniSharp'] }
" }}}

" OmniSharp: {{{
let g:OmniSharp_popup_position = 'peek'

let g:OmniSharp_popup_mappings = {
\ 'sigNext': '<C-n>',
\ 'sigPrev': '<C-p>',
\ 'pageDown': ['<C-f>', '<PageDown>'],
\ 'pageUp': ['<C-b>', '<PageUp>']
\}

let g:OmniSharp_want_snippet = 1

let g:OmniSharp_highlight_groups = {
\ 'ExcludedCode': 'NonText'
\}
" }}}

" Set this. Airline will handle the rest.
let g:airline#extensions#ale#enabled = 1

augroup OmniSharpIntegrations
  autocmd!
  autocmd User OmniSharpProjectUpdated,OmniSharpReady :AirlineRefresh 
augroup END
